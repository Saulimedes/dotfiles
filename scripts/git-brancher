#!/bin/bash

BRANCH=$1
ROOT=${2:-$(git rev-parse --abbrev-ref HEAD)}

if [[ -z "$BRANCH" || "$BRANCH" == $(git rev-parse --abbrev-ref HEAD) ]]; then
    git branch -a
elif [[ $(git show-ref --verify --quiet "refs/heads/$BRANCH") ]]; then
    git switch "$BRANCH"
else
    git fetch origin "$BRANCH"
    git checkout "$BRANCH"
    git branch --set-upstream-to=origin/"$BRANCH" "$BRANCH"
    git config "branch.$BRANCH.localmerge" "$ROOT"
fi

